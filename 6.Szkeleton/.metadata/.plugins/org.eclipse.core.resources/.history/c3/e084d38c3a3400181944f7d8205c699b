package server;
import sokoban.Irany;
import java.io.*;
import java.net.Socket;

public class Kapcsolat {
	
	Szerver szerver;

	Socket socket;
	
	ObjectOutputStream out;
	ObjectInputStream in;
	SzerverOlvaso rdr;
	
	public Kapcsolat(Szerver sz, Socket sock) 
	{
		szerver = sz;
		socket = sock;
		
		try {
			System.out.println("[SERVER]: Client connecting...");
			out = new ObjectOutputStream(socket.getOutputStream());
			in = new ObjectInputStream(socket.getInputStream());
			rdr = new SzerverOlvaso(in,this);
			rdr.start();
			System.out.println("[SERVER]: Client connected!");
		} catch (IOException e) {
			// TODO Auto-generated catch block
		}
	}
	
	public void Leptet(Irany i, String nev) 
	{
		szerver.Leptet(i, nev);
	}
	
	public void sendAdat(KliensAdat k) 
	{
		try {
			out.writeObject(k);
			out.flush();
		} catch (Exception e) {
			// TODO Auto-generated catch block
			System.out.println("[SERVER]: Client disconnected!");
			rdr.Kill();
			szerver.remKapcs(this);
		}
	}
	
	public void remKapcs() 
	{
		szerver.remKapcs(this);
	}
}
